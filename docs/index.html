<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>L5Sharp </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="L5Sharp ">
      
      <link rel="icon" href="favicon.ico">
      <link rel="stylesheet" href="public/docfx.min.css">
      <link rel="stylesheet" href="public/main.css">
      <meta name="docfx:navrel" content="toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      
      
      
      <meta name="docfx:docurl" content="https://github.com/tnunnink/L5Sharp/blob/main/docfx/index.md/#L1">
  </head>

  <script type="module">
    import options from './public/main.js'
    import { init } from './public/docfx.min.js'
    init(options)
  </script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="index.html">
            <img id="logo" class="svg" src="logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="l5sharp">L5Sharp</h1>

<p>A C# library for interacting with Rockwell's L5X import/export files.</p>
<h2 id="purpose">Purpose</h2>
<p>The purpose of this library is to offer a reusable, strongly typed, intuitive API
over Rockwell's L5X schema, allowing developers to quickly modify or generate L5X content,
that be used to build PLC projects files. In doing so, this library can aid in
creation of tools or scripts that automate the PLC development, maintenance, or testing processes
for automation engineers.</p>
<h2 id="goals">Goals</h2>
<p>The following are some high level goals this project aimed to accomplish.</p>
<ol>
<li>Provide a simple and intuitive API, making the learning curve as low as possible.</li>
<li>Ensure performance as much as possible without sacrificing simplicity.</li>
<li>Make it easy and seamless to extend the API to support custom queries or functions.</li>
<li>Support strongly typed mutable tag data, so we can reference complex structures statically at compile time.</li>
</ol>
<h2 id="feedback">Feedback</h2>
<p>If you like or use this project, leave a star. If you have questions or issues,
please post in the <a href="https://github.com/tnunnink/L5Sharp/issues">issues</a> tab
of the project repository. Any feedback is always appreciated. Enjoy!</p>
<h2 id="quick-start">Quick Start</h2>
<p>Install package from Nuget.</p>
<pre><code class="lang-powershell">Install-Package L5Sharp
</code></pre>
<p>Load an L5X file using the primary entry point <code>LogixContent</code> class.</p>
<pre><code class="lang-c#">var content = LogixContent.Load(&quot;C:\PathToMyFile\FileName.L5X&quot;);
</code></pre>
<p>Get started by querying any type across the L5X using the <code>Find&lt;T&gt;()</code> method.</p>
<pre><code class="lang-csharp">var tags = content.Find&lt;Tag&gt;();
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p><code>Find&lt;T&gt;()</code> returns an <code>IEnumerable&lt;T&gt;</code>, allowing for complex queries
using LINQ and the strongly typed objects in the library.
Since <code>Find&lt;T&gt;()</code> queries the entire L5X for the specified type, the above query
will return all <strong>Tag</strong> components found, including controller and program tags.</p>
</div>
<h2 id="usage">Usage</h2>
<p>The <code>LogixContent</code> class contains <code>LogixContainer</code> collections for all L5X components,
such as <a class="xref" href="api/L5Sharp.Components.Tag.html">Tag</a>, <a class="xref" href="api/L5Sharp.Components.DataType.html">DataType</a>,
<a class="xref" href="api/L5Sharp.Components.Module.html">Moulde</a>, and more.
These classes expose methods for querying and modifying the collections and components within the collections.
The following set of examples demonstrate these features using the Tags container.</p>
<h6 id="get-all">Get All</h6>
<p>Gets a list of all tags.</p>
<pre><code class="lang-c#">var tags = content.Tags.ToList();
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p><code>Tags</code> on the root <code>LogixContent</code> class is controller tags only.
To get program specific tags, access the <code>Tags</code> container of a
specific <code>Program</code> component.</p>
</div>
<h6 id="get-single">Get Single</h6>
<p>Get a tag by name.</p>
<pre><code class="lang-c#">var tag = content.Tags.Get(&quot;MyTag&quot;);
</code></pre>
<p>Get a tag by index.</p>
<pre><code class="lang-c#">var tag = content.Tags[4];
</code></pre>
<p>Find a tag by name.</p>
<pre><code class="lang-c#">var tag = content.Tags.Find(&quot;SomeTag&quot;);
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>Using <code>Find</code> will not throw an exception if the specified component is not found in
the L5X. Rather, it will simply return <code>null</code>.</p>
</div>
<h6 id="filter">Filter</h6>
<p>Perform complex filtering using LINQ.</p>
<pre><code class="lang-c#">var tags = content.Tags.Where(t =&gt; t.DataType == &quot;TIMER&quot; &amp;&amp; t.Dimensions.IsEmpty &amp;&amp; t[&quot;PRE&quot;].Value &gt;= 5000);
</code></pre>
<h6 id="add">Add</h6>
<p>Adds a new component to the container.</p>
<pre><code class="lang-c#">var tag = new Tag { Name = &quot;MyTag&quot;, Value = 100 };
content.Tags.Add(tag);
</code></pre>
<p>Add a new list of components to the container.</p>
<pre><code class="lang-c#">content.Tags.AddRange(new List&lt;Tag&gt;
{
    new() { Name = &quot;tag01&quot;, Value = 100 },
    new() { Name = &quot;tag02&quot;, Value = 200 },
    new() { Name = &quot;tag03&quot;, Value = 300 }
});
</code></pre>
<h6 id="update">Update</h6>
<p>Updating properties of a component will directly update the underlying L5X content.</p>
<pre><code class="lang-c#">var tag = content.Tags.Get(&quot;MyTag&quot;);
tag.Value = 1234;
tag.Description = &quot;This is a tag's description&quot;;
</code></pre>
<p>You may also want to apply and update to all components in a collection.</p>
<pre><code class="lang-csharp">content.Tags.Update(t =&gt; t.Comment = string.Empty);
</code></pre>
<p>Or better yet, update only components that satisfy a condition.</p>
<pre><code class="lang-csharp">content.Tags.Update(t =&gt; t.DataType == &quot;MyType&quot;, t =&gt; t.Comment = &quot;This is an instance ot MyType&quot;);
</code></pre>
<h6 id="insert">Insert</h6>
<p>Insert a component at a specific position in the container.</p>
<pre><code class="lang-c#">content.Tags.Insert(3, new new Tag { Name = &quot;MyTag&quot;, Value = 100 });
</code></pre>
<h6 id="remove">Remove</h6>
<p>Remove a component by name.</p>
<pre><code class="lang-c#">content.Tags.Remove(&quot;MyTag&quot;);
</code></pre>
<p>Remove all components that satisfy a condition.</p>
<pre><code class="lang-csharp">content.Tags.Remove(t =&gt; t.DataType == &quot;TypeName&quot;);
</code></pre>
<h6 id="save">Save</h6>
<p>Saving will write the current underlying L5X content to the specified file.</p>
<pre><code class="lang-c#">content.Save(&quot;C:\PathToMyOutputFile\FileName.L5X&quot;);
</code></pre>
<h2 id="tag-data">Tag Data</h2>
<h2 id="extensions">Extensions</h2>
<h2 id="references">References</h2>
<p>For more information regarding the structure and content of Rockwell's L5X file,
see [Logix 5000 Controllers Import Export](../refs/Logix 5000 Controllers Import Export.pdf)</p>
</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/tnunnink/L5Sharp/blob/main/docfx/index.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>
        
      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>


    <footer class="border-top">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>